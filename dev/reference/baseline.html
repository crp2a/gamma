<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Baseline Estimation and Removal — baseline • gamma</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Baseline Estimation and Removal — baseline"><meta name="description" content="Baseline Estimation and Removal"><meta property="og:description" content="Baseline Estimation and Removal"><meta property="og:image" content="https://crp2a.github.io/gamma/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gamma</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.5.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gamma.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/doserate.html">Obtaining a Dose Rate Calibration Curve</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/crp2a/gamma/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Baseline Estimation and Removal</h1>
      <small class="dont-index">Source: <a href="https://github.com/crp2a/gamma/blob/master/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/crp2a/gamma/blob/master/R/baseline.R" class="external-link"><code>R/baseline.R</code></a>, <a href="https://github.com/crp2a/gamma/blob/master/R/baseline_linear.R" class="external-link"><code>R/baseline_linear.R</code></a>, and 2 more</small>
      <div class="d-none name"><code>baseline.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Baseline Estimation and Removal</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">signal_baseline</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">signal_correct</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">baseline_snip</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">baseline_rubberband</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">baseline_linear</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectrum'</span></span>
<span><span class="fu">signal_baseline</span><span class="op">(</span><span class="va">object</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNIP"</span>, <span class="st">"rubberband"</span>, <span class="st">"linear"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectra'</span></span>
<span><span class="fu">signal_baseline</span><span class="op">(</span><span class="va">object</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNIP"</span>, <span class="st">"rubberband"</span>, <span class="st">"linear"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectrum'</span></span>
<span><span class="fu">signal_correct</span><span class="op">(</span><span class="va">object</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNIP"</span>, <span class="st">"rubberband"</span>, <span class="st">"linear"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectra'</span></span>
<span><span class="fu">signal_correct</span><span class="op">(</span><span class="va">object</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNIP"</span>, <span class="st">"rubberband"</span>, <span class="st">"linear"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectrum'</span></span>
<span><span class="fu">baseline_linear</span><span class="op">(</span><span class="va">object</span>, from <span class="op">=</span> <span class="cn">NULL</span>, to <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectra'</span></span>
<span><span class="fu">baseline_linear</span><span class="op">(</span><span class="va">object</span>, from <span class="op">=</span> <span class="cn">NULL</span>, to <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectrum'</span></span>
<span><span class="fu">baseline_rubberband</span><span class="op">(</span><span class="va">object</span>, noise <span class="op">=</span> <span class="fl">0</span>, spline <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectra'</span></span>
<span><span class="fu">baseline_rubberband</span><span class="op">(</span><span class="va">object</span>, noise <span class="op">=</span> <span class="fl">0</span>, spline <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectrum'</span></span>
<span><span class="fu">baseline_snip</span><span class="op">(</span><span class="va">object</span>, LLS <span class="op">=</span> <span class="cn">FALSE</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span>, n <span class="op">=</span> <span class="fl">100</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectra'</span></span>
<span><span class="fu">baseline_snip</span><span class="op">(</span><span class="va">object</span>, LLS <span class="op">=</span> <span class="cn">FALSE</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span>, n <span class="op">=</span> <span class="fl">100</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <a href="GammaSpectrum-class.html">GammaSpectrum</a> or <a href="GammaSpectra-class.html">GammaSpectra</a>
object.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Extra parameters to be passed to further methods.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> string specifying the method to be used for
baseline estimation (see details). Any unambiguous substring can be given.</p></dd>


<dt id="arg-from">from<a class="anchor" aria-label="anchor" href="#arg-from"></a></dt>
<dd><p>An <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></code> giving the first channel to be used for linear
interpolation. If <code>NULL</code> (the default), channel \(1\) is used.
Only used if <code>method</code> is "<code>linear</code>".</p></dd>


<dt id="arg-to">to<a class="anchor" aria-label="anchor" href="#arg-to"></a></dt>
<dd><p>An <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></code> giving the last channel to be used for linear
interpolation. If <code>NULL</code> (the default), channel \(max\) is used.
Only used if <code>method</code> is "<code>linear</code>".</p></dd>


<dt id="arg-noise">noise<a class="anchor" aria-label="anchor" href="#arg-noise"></a></dt>
<dd><p>A length-one <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> vector giving the noise level.
Only used if <code>method</code> is "<code>rubberband</code>".</p></dd>


<dt id="arg-spline">spline<a class="anchor" aria-label="anchor" href="#arg-spline"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> scalar: should spline interpolation through the
support points be used instead of linear interpolation?
Only used if <code>method</code> is "<code>rubberband</code>".</p></dd>


<dt id="arg-lls">LLS<a class="anchor" aria-label="anchor" href="#arg-lls"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> scalar: should the LLS operator be applied on <code>x</code>
before employing SNIP algorithm? Only used if <code>method</code> is "<code>SNIP</code>".</p></dd>


<dt id="arg-decreasing">decreasing<a class="anchor" aria-label="anchor" href="#arg-decreasing"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> scalar: should a decreasing clipping window
be used? Only used if <code>method</code> is "<code>SNIP</code>".</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>An <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></code> value giving the number of iterations.
Only used if <code>method</code> is "<code>SNIP</code>".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p><code>baseline_*()</code> returns a <a href="Baseline-class.html">BaseLine</a> object.</p></li>
<li><p><code>signal_correct()</code> returns a corrected <a href="GammaSpectrum-class.html">GammaSpectrum</a> or
<a href="GammaSpectra-class.html">GammaSpectra</a> object (same as <code>object</code>).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The following methods are available for baseline estimation:</p><dl><dt><code>SNIP</code></dt>
<dd><p>Sensitive Nonlinear Iterative Peak clipping algorithm.</p></dd>

<dt><code>rubberband</code></dt>
<dd><p>A convex envelope of the spectrum is determined and the
baseline is estimated as the part of the convex envelope lying below the
spectrum. Note that the rubber band does not enter the concave regions
(if any) of the spectrum.</p></dd>

<dt><code>linear</code></dt>
<dd><p>Linear baseline estimation.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><code>baseline_rubberband()</code> is slightly modified from C. Beleites'
<code>hyperSpec::spc.rubberband()</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Liland, K. H. (2015). 4S Peak Filling - baseline estimation by iterative
mean suppression. <em>MethodsX</em>, 2, 135-140. <a href="https://doi.org/10.1016/j.mex.2015.02.009" class="external-link">doi:10.1016/j.mex.2015.02.009</a>
.</p>
<p>Morháč, M., Kliman, J., Matoušek, V., Veselský, M. &amp; Turzo, I. (1997).
Background elimination methods for multidimensional gamma-ray spectra.
<em>Nuclear Instruments and Methods in Physics Research Section A:
Accelerators, Spectrometers, Detectors and Associated Equipment</em>, 401(1),
p. 113-132. <a href="https://doi.org/10.1016/S0168-9002%2897%2901023-1" class="external-link">doi:10.1016/S0168-9002(97)01023-1</a></p>
<p>Morháč, M. &amp; Matoušek, V. (2008). Peak Clipping Algorithms for Background
Estimation in Spectroscopic Data. <em>Applied Spectroscopy</em>, 62(1), p. 91-106.
<a href="https://doi.org/10.1366/000370208783412762" class="external-link">doi:10.1366/000370208783412762</a></p>
<p>Ryan, C. G., Clayton, E., Griffin, W. L., Sie, S. H. &amp; Cousens, D. R.
(1988). SNIP, a statistics-sensitive background treatment for the
quantitative analysis of PIXE spectra in geoscience applications.
<em>Nuclear Instruments and Methods in Physics Research Section B:
Beam Interactions with Materials and Atoms</em>, 34(3), p. 396-402.
<a href="https://doi.org/10.1016/0168-583X%2888%2990063-8" class="external-link">doi:10.1016/0168-583X(88)90063-8</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other signal processing:
<code><a href="peaks_find.html">peaks_find</a>()</code>,
<code><a href="peaks_search.html">peaks_search</a>()</code>,
<code><a href="integrate.html">signal_integrate</a>()</code>,
<code><a href="signal_slice.html">signal_slice</a>()</code>,
<code><a href="signal_split.html">signal_split</a>()</code>,
<code><a href="stabilize.html">signal_stabilize</a>()</code>,
<code><a href="smooth.html">smooth</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>N. Frerebeau</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Import a CNF file</span></span></span>
<span class="r-in"><span><span class="va">spc_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/LaBr.CNF"</span>, package <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spc</span> <span class="op">&lt;-</span> <span class="fu"><a href="read.html">read</a></span><span class="op">(</span><span class="va">spc_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Remove the first 35 channels</span></span></span>
<span class="r-in"><span><span class="va">spc</span> <span class="op">&lt;-</span> <span class="fu"><a href="signal_slice.html">signal_slice</a></span><span class="op">(</span><span class="va">spc</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Linear baseline</span></span></span>
<span class="r-in"><span><span class="va">bsl_linear</span> <span class="op">&lt;-</span> <span class="fu">baseline_linear</span><span class="op">(</span><span class="va">spc</span>, from <span class="op">=</span> <span class="fl">250</span>, to <span class="op">=</span> <span class="fl">750</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">spc</span>, <span class="va">bsl_linear</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="baseline-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## SNIP baseline</span></span></span>
<span class="r-in"><span><span class="va">bsl_snip</span> <span class="op">&lt;-</span> <span class="fu">baseline_snip</span><span class="op">(</span><span class="va">spc</span>, LLS <span class="op">=</span> <span class="cn">FALSE</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">spc</span>, <span class="va">bsl_snip</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="baseline-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Rubberband baseline</span></span></span>
<span class="r-in"><span><span class="va">bsl_rubber</span> <span class="op">&lt;-</span> <span class="fu">baseline_rubberband</span><span class="op">(</span><span class="va">spc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">spc</span>, <span class="va">bsl_rubber</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="baseline-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Remove baseline</span></span></span>
<span class="r-in"><span><span class="va">spc_clean1</span> <span class="op">&lt;-</span> <span class="fu">signal_correct</span><span class="op">(</span><span class="va">spc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spc_clean2</span> <span class="op">&lt;-</span> <span class="va">spc</span> <span class="op">-</span> <span class="va">bsl_snip</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">spc_clean1</span> <span class="op">==</span> <span class="va">spc_clean2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">spc_clean1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="baseline-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Frerebeau, Brice Lebrun, Guilhem Paradol, Sebastian Kreutzer, <a href="https://www.archeosciences-bordeaux.fr.fr" class="external-link"><img src="https://crp2a.github.io/gamma/reference/figures/logo_archeosciences.jpg"></a>, <a href="https://www.u-bordeaux-montaigne.fr" class="external-link"><img src="https://crp2a.github.io/gamma/reference/figures/logo_ubm.jpg"></a>, <a href="https://www.cnrs.fr" class="external-link"><img src="https://crp2a.github.io/gamma/reference/figures/logo_cnrs.jpg"></a>, <a href="https://lascarbx.labex.u-bordeaux.fr" class="external-link"><img src="https://crp2a.github.io/gamma/reference/figures/logo_idex.png"></a>, <a href="https://amidex.univ-amu.fr" class="external-link"><img src="https://crp2a.github.io/gamma/reference/figures/logo_amidex.jpg"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

