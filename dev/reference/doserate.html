<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Dose Rate Estimation — doserate • gamma</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dose Rate Estimation — doserate"><meta name="description" content="dose_fit builds a calibration curve for gamma dose rate estimation."><meta property="og:description" content="dose_fit builds a calibration curve for gamma dose rate estimation."><meta property="og:image" content="https://crp2a.github.io/gamma/logo.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@archeosciences"><meta name="twitter:site" content="@archeosciences"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gamma</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.5.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gamma.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/doserate.html">Calibration Curve</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/crp2a/gamma/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Dose Rate Estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/crp2a/gamma/blob/master/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/crp2a/gamma/blob/master/R/dose_fit.R" class="external-link"><code>R/dose_fit.R</code></a>, <a href="https://github.com/crp2a/gamma/blob/master/R/dose_predict.R" class="external-link"><code>R/dose_predict.R</code></a></small>
      <div class="d-none name"><code>doserate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>dose_fit</code> builds a calibration curve for gamma dose rate estimation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dose_fit</span><span class="op">(</span><span class="va">object</span>, <span class="va">background</span>, <span class="va">doses</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dose_predict</span><span class="op">(</span><span class="va">object</span>, <span class="va">spectrum</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectra,GammaSpectrum,matrix'</span></span>
<span><span class="fu">dose_fit</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">background</span>,</span>
<span>  <span class="va">doses</span>,</span>
<span>  <span class="va">range_Ni</span>,</span>
<span>  <span class="va">range_NiEi</span>,</span>
<span>  details <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>authors <span class="op">=</span> <span class="st">""</span>, date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GammaSpectra,GammaSpectrum,data.frame'</span></span>
<span><span class="fu">dose_fit</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">background</span>,</span>
<span>  <span class="va">doses</span>,</span>
<span>  <span class="va">range_Ni</span>,</span>
<span>  <span class="va">range_NiEi</span>,</span>
<span>  details <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>authors <span class="op">=</span> <span class="st">""</span>, date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'CalibrationCurve,missing'</span></span>
<span><span class="fu">dose_predict</span><span class="op">(</span><span class="va">object</span>, sigma <span class="op">=</span> <span class="fl">1</span>, epsilon <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'CalibrationCurve,GammaSpectrum'</span></span>
<span><span class="fu">dose_predict</span><span class="op">(</span><span class="va">object</span>, <span class="va">spectrum</span>, sigma <span class="op">=</span> <span class="fl">1</span>, epsilon <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'CalibrationCurve,GammaSpectra'</span></span>
<span><span class="fu">dose_predict</span><span class="op">(</span><span class="va">object</span>, <span class="va">spectrum</span>, sigma <span class="op">=</span> <span class="fl">1</span>, epsilon <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <a href="GammaSpectra-class.html">GammaSpectra</a> or <a href="CalibrationCurve-class.html">CalibrationCurve</a> object.</p></dd>


<dt id="arg-background">background<a class="anchor" aria-label="anchor" href="#arg-background"></a></dt>
<dd><p>A <a href="GammaSpectrum-class.html">GammaSpectrum</a> object of a length-two <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code>
vector giving the background noise integration value and error,
respectively.</p></dd>


<dt id="arg-doses">doses<a class="anchor" aria-label="anchor" href="#arg-doses"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></code> or <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code> TODO.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Currently not used.</p></dd>


<dt id="arg-spectrum">spectrum<a class="anchor" aria-label="anchor" href="#arg-spectrum"></a></dt>
<dd><p>An optional <a href="GammaSpectrum-class.html">GammaSpectrum</a> or <a href="GammaSpectra-class.html">GammaSpectra</a>
object in which to look for variables with which to predict. If omitted,
the fitted values are used.</p></dd>


<dt id="arg-range-ni-range-niei">range_Ni, range_NiEi<a class="anchor" aria-label="anchor" href="#arg-range-ni-range-niei"></a></dt>
<dd><p>A length-two <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> vector giving the energy
range to integrate within (in keV).</p></dd>


<dt id="arg-details">details<a class="anchor" aria-label="anchor" href="#arg-details"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> of length-one vector specifying additional
informations about the instrument for which the curve is built.</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> value giving TODO.</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> value giving an extra error term
introduced by the calibration of the energy scale of the spectrum.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p><code>dose_fit()</code> returns a <a href="CalibrationCurve-class.html">CalibrationCurve</a> object.</p></li>
<li><p><code>dose_predict()</code> returns a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code> with the following columns:</p><dl><dt><code>name</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code>) the name of the spectra.</p></dd>

<dt><code>*_signal</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code>) the integrated signal value (according to
the value of <code>threshold</code>; see <code><a href="integrate.html">signal_integrate()</a></code>).</p></dd>

<dt><code>*_error</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code>) the integrated signal error value
(according to the value of <code>threshold</code>; see <code><a href="integrate.html">signal_integrate()</a></code>).</p></dd>

<dt><code>gamma_signal</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code>) the predicted gamma dose rate.</p></dd>

<dt><code>gamma_error</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code>) the predicted gamma dose rate error.</p></dd>


</dl></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>dose_predict</code> predicts in situ gamma dose rate.</p>
<p>To estimate the gamma dose rate, one of the calibration curves distributed
with this package can be used. These built-in curves are in use in several
luminescence dating laboratories and can be used to replicate published
results. As these curves are instrument specific, the user may have to build
its own curve.</p>
<p>The construction of a calibration curve requires a set of reference spectra
for which the gamma dose rate is known and a background noise measurement.
First, each reference spectrum is integrated over a given interval, then
normalized to active time and corrected for background noise. The dose rate
is finally modelled by the integrated signal value used as a linear
predictor (York <em>et al.</em>, 2004).</p>
<p>See <code>vignette(doserate)</code> for a reproducible example.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mercier, N. &amp; Falguères, C. (2007). Field Gamma Dose-Rate Measurement with
a NaI(Tl) Detector: Re-Evaluation of the "Threshold" Technique.
<em>Ancient TL</em>, 25(1), p. 1-4.</p>
<p>York, D., Evensen, N. M., Martínez, M. L. &amp; De Basabe Delgado, J. (2004).
Unified Equations for the Slope, Intercept, and Standard Errors of the Best
Straight Line. <em>American Journal of Physics</em>, 72(3), p. 367-75.
<a href="https://doi.org/10.1119/1.1632486" class="external-link">doi:10.1119/1.1632486</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="integrate.html">signal_integrate()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>N. Frerebeau</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Import CNF files</span></span></span>
<span class="r-in"><span><span class="co">## Spectra</span></span></span>
<span class="r-in"><span><span class="va">spc_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/BDX_LaBr_1/calibration"</span>, package <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spc</span> <span class="op">&lt;-</span> <span class="fu"><a href="read.html">read</a></span><span class="op">(</span><span class="va">spc_dir</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Background</span></span></span>
<span class="r-in"><span><span class="va">bkg_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/BDX_LaBr_1/background"</span>, package <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="read.html">read</a></span><span class="op">(</span><span class="va">bkg_dir</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get dose rate values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"clermont"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">doses</span> <span class="op">&lt;-</span> <span class="va">clermont</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gamma_dose"</span>, <span class="st">"gamma_error"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        gamma_dose gamma_error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BRIQUE  1986.4620   35.619679</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C341     849.9668   21.317615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C347    1423.8589   25.249756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GOU     1575.2249   17.433789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LAS     1083.6737    9.570593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LMP      641.9004   17.560649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MAZ     1141.4033   11.665045</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MPX      964.0196   13.274167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEP     2538.2217  112.169131</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Build the calibration curve</span></span></span>
<span class="r-in"><span><span class="va">calib_curve</span> <span class="op">&lt;-</span> <span class="fu">dose_fit</span><span class="op">(</span><span class="va">spc</span>, <span class="va">bkg</span>, <span class="va">doses</span>,</span></span>
<span class="r-in"><span>                        range_Ni <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">2800</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        range_NiEi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">165</span>, <span class="fl">2800</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the curve</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">calib_curve</span>, threshold <span class="op">=</span> <span class="st">"Ni"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="doserate-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimate gamma dose rates</span></span></span>
<span class="r-in"><span><span class="fu">dose_predict</span><span class="op">(</span><span class="va">calib_curve</span>, <span class="va">spc</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    names   dose_Ni  error_Ni dose_NiEi error_NiEi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 BRIQUE 1955.8683 2934.1305 1946.9606  2920.7064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   C341  843.9938 1266.1669  843.0632  1264.7097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   C347 1420.1912 2130.5630 1402.5391  2103.9999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    GOU 1599.0175 2398.8191 1598.6341  2398.1692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    LMP  640.1782  960.4183  639.0612   958.6789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    MAZ 1140.4575 1710.9077 1144.1496  1716.3805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    PEP 2443.3517 3665.4815 2435.1440  3653.0481</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Frerebeau, Brice Lebrun, Guilhem Paradol, Sebastian Kreutzer, <a href="https://www.archeosciences-bordeaux.fr.fr" class="external-link"><img src="https://crp2a.github.io/gamma/reference/figures/logo_archeosciences.jpg"></a>, <a href="https://www.u-bordeaux-montaigne.fr" class="external-link"><img src="https://crp2a.github.io/gamma/reference/figures/logo_ubm.jpg"></a>, <a href="https://www.cnrs.fr" class="external-link"><img src="https://crp2a.github.io/gamma/reference/figures/logo_cnrs.jpg"></a>, <a href="https://lascarbx.labex.u-bordeaux.fr" class="external-link"><img src="https://crp2a.github.io/gamma/reference/figures/logo_idex.png"></a>, <a href="https://amidex.univ-amu.fr" class="external-link"><img src="https://crp2a.github.io/gamma/reference/figures/logo_amidex.jpg"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

